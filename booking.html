<html>
  <meta charset="utf-8" />
  <meta name="format-detection" content="telephone=no" />
  <meta name="msapplication-tap-highlight" content="no" />
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width" />
  <!-- This is a wide open CSP declaration. To lock this down for production, see below. -->
  <!--<meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline'; style-src 'self' 'unsafe-inline'; media-src *" /> -->
  <script type="text/javascript" src="cordova.js"></script>
  <!--<script type="text/javascript" src="js/index.js"></script>-->
  <script src="node_modules/onsenui/js/onsenui.min.js"></script>
	<meta name="format-detection" content="telephone=no">
  <meta name="msapplication-tap-highlight" content="no">
  <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">
	<head>
		<link rel="stylesheet" type="text/css" href="css/style.css">
		<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="js/jquery-3.2.1.min.js"></script>
		<script type="text/javascript" src="jquery-ui-1.12.1.custom/jquery-ui.js"></script>
		<script type="text/javascript" src="jquery-ui-1.12.1.custom/jquery.ui.touch-punch.min.js"></script>

		<link rel="stylesheet" href="node_modules/onsenui/css/onsenui.css">
		<link rel="stylesheet" href="node_modules/onsenui/css/onsen-css-components.min.css">

		<script>
			$(function() {
				$("#banner > div:gt(0)").hide();
				setInterval(function() {
				  $('#banner > div:first')
					.fadeOut(1000)
					.next()
					.fadeIn(1000)
					.end()
					.appendTo('#banner');
				},  3000);
			});
		</script>

		<style>
		  .carousel-inner > .item > img,
		  .carousel-inner > .item > a > img{
			  width: 100%;
			  margin: auto;
		  }
	  </style>
	</head>

	<body>

    <ons-splitter>
      <ons-splitter-side id="menu" side="left" width="220px" swipe-target-width="125px" collapse swipeable >
        <ons-page>
          <ons-list id="chatMember">
            <ons-list-header><img src='logo.png' width='70%'></ons-list-header>
            <a href="next.html" style="text-decoration:none;"><ons-list-item class="mentionBtn" tappable>Home</ons-list-item></a>
            <a href="about.html" style="text-decoration:none;"><ons-list-item class="mentionBtn" tappable>About</ons-list-item></a>
            <a href="profile.html" style="text-decoration:none;"><ons-list-item class="mentionBtn" tappable>Profile</ons-list-item></a>
            <a href="founders.html" style="text-decoration:none;"><ons-list-item class="mentionBtn" tappable>Founders</ons-list-item></a>
            <ons-list-item style="position:absolute;overflow:hidden;bottom:0;" class="mentionBtn" onclick="onBackKeyDown()" tappable>Logout</ons-list-footer>
          </ons-list>
        </ons-page>
      </ons-splitter-side>
      <ons-splitter-content id="content" page="home.html"></ons-splitter-content>
    </ons-splitter>
    <template id="home.html">
    <ons-page id="page1">
        <ons-toolbar style="background-color:white;">
        <div class="left">
            <ons-toolbar-button onclick="fn.open()">
                <ons-icon icon="md-menu" style="color:black;"></ons-icon>
            </ons-toolbar-button>
        </div>

        <div class="center" style="color:black;">
          Go & Rent
        </div>
        </ons-toolbar>

		<div class="contProfile" style="width:100%;height:auto;margin-bottom:100px;margin-top:10px;">
			<form method='post' class="editProf" align="left">
				<p align="left" style="margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;color:gray;">Full name</p>
				<input type="text" id="txtName" name="name" value=""><br>
				<p align="left" style="margin-top:30px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:relative;color:gray;">Email</p>
				<input type="text" id="txtEmail" name="email" value=""><br>
				<p align="left" style="margin-top:30px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:relative;color:gray;">ID Number</p>
				<input type="text" id="txtID" name="ktp" value=""><br>
				<p align="left" style="margin-top:30px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:relative;color:gray;">Phone Number</p>
				<input type="text" id="txtPhone" name="phone" value=""><br>
				<p align="left" style="margin-top:30px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:relative;color:gray;">Check In</p>
				<input type="date" id="dateCI" name="dateCheckIn" min="" value="" disabled><br>
				<p align="left" style="margin-top:30px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:relative;color:gray;">Check Out</p>
				<input type="date" id="dateCO" name="dateCheckIn" min="" value="" disabled><br>
				<p align="left" style="margin-top:30px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:relative;color:gray;">Guests</p>
				<div id="guest" style="width:auto height:auto; margin-left:20px;position:absolute">
					<div id="plusButton" onclick="gantiangka('minus')" style="width:1.7em;height:1.7em;position:relative;border-radius:50px;margin-top:5px;background-image:url(img/min.png);background-size:cover;repeat:no-repeat;float:left;"></div>
					<input type="text" name="numberGuest" id="txtNumberGuests" value="1" style="width:60%;float:left;position:relative">
					<div id="plusButton" onclick="gantiangka('plus')" style="width:1.7em;height:1.7em;position:relative;margin-left:20px;margin-top:5px;border-radius:50px;background-image:url(img/add.png);background-size:cover;repeat:no-repeat;float:left;"></div>
				</div>
				<p align="left" style="margin-top:60px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:relative;color:gray;">Location Detail</p>
				<p id="locationDetail" align="left" style="margin-left:20px;font-family:AgencyFB;font-size:1.3em;font-weight:none;position:relative;color:gray;">Ngagel Jaya Tengah No. 70-73, Kecamatan Gubeng, Surabaya, Jawa Timur</p>
				<p align="left" style="margin-top:20px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:absolute;color:gray;float:left;color:lightgray;">Harga permalam x malam</p>
				<p id="subTotal" align="left" style="margin-top:20px;right:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:absolute;color:gray;;color:lightgray;">Rp xxxxxxxx</p><br><br>
				<p align="left" style="margin-top:20px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:absolute;color:gray;float:left;color:lightgray;">Service Fee (10%)</p>
				<p id="serviceFee" align="left" style="margin-top:20px;right:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:absolute;color:gray;;color:lightgray;">Rp xxxxxxxx</p><br><br>
				<p align="left" style="margin-top:20px;margin-left:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:absolute;color:gray;float:left">Total</p>
				<p id="grandTotal" align="left" style="margin-top:20px;right:20px;font-family:AgencyFB;font-size:1.5em;font-weight:none;position:absolute;color:gray;margin-bottom:80px;">Rp xxxxxxxx</p>
		</div>

		<footer style="text-align:right;padding-right:20px;">
				<input type="button" name="btnBooking" onclick="insertBook()" value="Book" style="width:30%;height:60%;background-color:#f94d6e;border-radius:10px;font-size:1.5em;color:white;top:20%;position:relative;">
			</form>
		</footer>
  </ons-page>
  </template>
	</body>
  <script type="text/javascript">
  var server = "http://192.168.1.3/sdpajax/server.php";
  var ini,ini2;
  var latkita=0,longkita=0;
  var max=100;
  var hargatotal = 0;
  function insertBook(){
    $.post(server, {'idbook':ini+ini2 , 'checkin' : $("#dateCI").val() , 'checkout' : $("#dateCO").val(), 'guest' : $("#txtNumberGuests").val() , 'ktp' : $("#txtID").val() ,'total' : hargatotal, 'userskr' : ini , 'idrumah' : ini2 ,'tipe': "insertBook"},function(data){
      alert("Terima Kasih Atas Booking Anda!");
      window.location="next.html";
    });
  }
  function gantiangka(id){
    var isinya = parseInt($("#txtNumberGuests").val());
    if(id=='minus'){
      if (isinya-1>0) {
        isinya--;
        $("#txtNumberGuests").val(isinya);
      }
    }else{
      if (isinya+1<max) {
        isinya++;
        $("#txtNumberGuests").val(isinya);
      }
    }
  }
    document.addEventListener("deviceready", onDeviceReady, false);
    var onSuccess = function(position) {
          /*alert('Latitude: '          + position.coords.latitude          + '\n' +
                'Longitude: '         + position.coords.longitude         + '\n' +
                'Altitude: '          + position.coords.altitude          + '\n' +
                'Accuracy: '          + position.coords.accuracy          + '\n' +
                'Altitude Accuracy: ' + position.coords.altitudeAccuracy  + '\n' +
                'Heading: '           + position.coords.heading           + '\n' +
                'Speed: '             + position.coords.speed             + '\n' +
                'Timestamp: '         + position.timestamp                + '\n');*/
          latkita = position.coords.latitude;
          longkita = position.coords.longitude;
      };

      // onError Callback receives a PositionError object
      //
      function onError(error) {
          alert('code: '    + error.code    + '\n' +
                'message: ' + error.message + '\n');
      }
      function pindahDetail(id){
        localStorage.setItem("detailID",id);
        window.location = "detail.html";
      }
      const numberWithCommas = (x) => {
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
      }
    function onDeviceReady(){
      ini = localStorage.getItem("storageName") != null ? localStorage.getItem("storageName") : "tm_tr" ;
      ini2 = localStorage.getItem("detailID") != null ? localStorage.getItem("detailID") : "gdaniel";
      $("#dateCI").val(localStorage.getItem("checkin"));
      $("#dateCO").val(localStorage.getItem("checkout"));
      var date1 = new Date($("#dateCI").val());
      var date2 = new Date($("#dateCO").val());
      var selisih = 1;
      selisih = ((date2 - date1)/3600/24/1000);
      navigator.geolocation.getCurrentPosition(onSuccess, onError);
      $.post(server, {'id': ini2,'tipe': "ambilDetail"},function(data){
        data = JSON.parse(data);
        console.log(data);
        max = parseInt(data.kapasitas);
        $("#locationDetail").html(data.alamat_rumah);
        $("#subTotal").html("Rp. "+numberWithCommas(parseInt(data.harga)*selisih));
        $("#serviceFee").html("Rp. "+numberWithCommas(parseInt(data.harga/10)*selisih));
        $("#grandTotal").html("Rp. "+numberWithCommas((parseInt(data.harga)+parseInt(data.harga/10))*selisih));
        hargatotal = (parseInt(data.harga)+parseInt(data.harga/10))*selisih;
      });
    };
    $(document).ready(onDeviceReady);
    window.fn = {};
    window.fn.open = function() {
        let menu = document.getElementById('menu');
        menu.open();
    };

    window.fn.close = function() {
        let menu = document.getElementById('menu');
        menu.close();
    };
    function makeNotification() {
        cordova.plugins.notification.local.schedule({
            id: 1,
            title: "Coba Coba",
            text: "Hai Hai Timo"
        });
    };
    function onBackKeyDown(){
      window.location="index.html";
      window.plugins.googleplus.disconnect(
        function (msg) {
          //alert("Berhasil Logout Google"); // do something useful instead of alerting
        },function (msg) {
          //alert("Gagal Logout Google"); // do something useful instead of alerting
          //alert(msg);

        }
      );
      facebookConnectPlugin.api("/me/permissions?method=delete", ['email','user_birthday','public_profile'],function (msg) {
        //alert("Berhasil Logout  Facebook"); // do something useful instead of alerting
      }, function (msg) {
        //alert("Gagal Logout Facebook"); // do something useful instead of alerting
        //alert(msg);
      });
      facebookConnectPlugin.logout(function (msg) {
        //alert("Berhasil Logout  Facebook"); // do something useful instead of alerting
      }, function (msg) {
        //alert("Gagal Logout Facebook"); // do something useful instead of alerting
        //alert(msg);
      });
    }
  app.initialize();

  </script>
</html>
